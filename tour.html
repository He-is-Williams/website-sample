<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tour Detail | Wanderlust Adventures</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="top-bar">
        <div class="container">
            <div>
                <span>üìû +254 700 123 456</span>
                <span>‚úâÔ∏è @MagicalHolidayDestination</span>
            </div>
            <div>
                <a href="#">Become a Tour Guide</a>
            </div>
        </div>
    </div>

    <header>
        <div class="navbar">
            <a href="index.html" class="logo"><span>Magical Holiday</span> Destinations Ltd</a>
            <nav>
                <ul>
                    <li><a href="index.html#home">Home</a></li>
                    <li class="has-dropdown">
                        <a href="destinations.html" class="dropdown-link">Destinations</a>
                        <button class="dropdown-toggle" aria-expanded="false" aria-controls="destinations-menu" aria-label="Open destinations menu">‚ñæ</button>
                        <div class="mega-menu" id="destinations-menu" role="menu" aria-hidden="true">
                            <div class="mega-menu-inner">
                                <div class="mega-column">
                                    <h4>Africa</h4>
                                    <ul>
                                        <li><a href="index.html#kenya">Kenya</a></li>
                                        <li><a href="index.html#mauritius">Mauritius</a></li>
                                        <li><a href="index.html#south-africa">South Africa</a></li>
                                        <li><a href="index.html#tanzania">Tanzania</a></li>
                                    </ul>
                                </div>
                                <div class="mega-column">
                                    <h4>Middle East</h4>
                                    <ul>
                                        <li><a href="index.html#china">China</a></li>
                                        <li><a href="index.html#pakistan">Pakistan</a></li>
                                        <li><a href="index.html#singapore">Singapore</a></li>
                                        <li><a href="index.html#uae">UAE (Dubai)</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li><a href="index.html#tours">Tours</a></li>
                    <li><a href="index.html#articles">Articles</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-btn" onclick="toggleMenu()">‚ò∞</button>
            <div>
                <a href="cart.html" class="cart-link" id="nav-cart-link" aria-label="View cart">
                    <span class="cart-icon">üõí</span>
                    <span id="nav-cart-count" class="cart-count hidden">0</span>
                </a>
                <a href="account.html" id="nav-account-link" class="account-link" aria-label="Account"><i class="fa-solid fa-user" aria-hidden="true"></i></a>
            </div>
        </div>
    </header>

    <main>
        <section class="tour-hero" id="tour-hero">
            <div class="tour-hero-content">
                <div class="tour-hero-copy">
                    <div>
                        <p class="section-tag light">Tour Details</p>
                        <h1 id="tour-title">Tour Title</h1>
                        <p id="tour-location" class="muted">Location</p>
                        <div class="tour-hero-meta">
                            <span id="tour-duration">Duration</span>
                            <span id="tour-rating">Rating</span>
                            <span id="tour-price-label">Price</span>
                        </div>
                        <div class="tour-hero-badges">
                            <span id="tour-next-departure">Next departure coming soon</span>
                            <span class="hero-pill">Small groups</span>
                            <span class="hero-pill">Curated experiences</span>
                        </div>
                    </div>
                </div>
                <div class="tour-hero-panel">
                    <p class="tour-hero-panel-label">Secured departure</p>
                    <p class="tour-hero-panel-price" id="tour-price-card">Price</p>
                    <p class="tour-hero-panel-note">Space is limited to just 12 travelers for this date.</p>
                    <button class="btn-primary btn-full" id="book-tour">Book this tour</button>
                </div>
            </div>
        </section>

        <section class="section tour-detail-section">
            <div class="container">
                <div class="tour-grid">
                    <article class="tour-body">
                        <h3>Overview</h3>
                        <p id="tour-description">The full tour description goes here.</p>

                        <h3>Why travelers choose this</h3>
                        <ul id="tour-highlights"></ul>

                        <h3>Sample itinerary</h3>
                        <div id="tour-itinerary"></div>
                    </article>
                    <aside class="tour-sidebar">
                        <div class="detail-card">
                            <h4>What's included</h4>
                            <ul id="tour-includes"></ul>
                        </div>
                        <div class="detail-card">
                            <h4>Need to know</h4>
                            <ul>
                                <li>Group size: Up to 12 guests</li>
                                <li>Meals: Select breakfasts &amp; dinners</li>
                                <li>Transport: Luxury coach or safari vehicle</li>
                                <li>Experience level: Moderate</li>
                            </ul>
                        </div>
                        <button class="btn-secondary btn-full" id="download-itinerary">Download itinerary</button>
                    </aside>
                </div>

                <div class="tour-similar" id="tour-similar">
                    <h3>More experiences like this</h3>
                    <div class="similar-grid" id="similar-grid"></div>
                </div>
            </div>
        </section>
    </main>

    <footer id="contact">
        <div class="footer-content">
            <div class="footer-section">
                <h3>WanderLust Adventures</h3>
                <p>Creating unforgettable travel experiences around the world.</p>
                <p>üìû +254 700 123 456</p>
                <p>‚úâÔ∏è hello@wanderlust.com</p>
                <p>üìç Nairobi, Kenya</p>
            </div>
            <div class="footer-section">
                <h3>Company</h3>
                <ul>
                    <li><a href="index.html#about">About Us</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Press</a></li>
                    <li><a href="#">Partners</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Support</h3>
                <ul>
                    <li><a href="index.html#contact">Contact</a></li>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Terms &amp; Conditions</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Travel Insurance</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Newsletter</h3>
                <p>Subscribe to get special offers and travel tips</p>
                <form class="newsletter-form" onsubmit="subscribeNewsletter(event)">
                    <input type="email" id="newsletter-email" placeholder="Your email" required>
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 WanderLust Adventures. All rights reserved.</p>
        </div>
    </footer>

    <script src="data/destinations.js"></script>
    <script src="script.js"></script>
    <script>
        const getTourEntry = () => {
            const params = new URLSearchParams(window.location.search);
            const index = Number(params.get('index'));
            const catalog = window.SEARCH_CATALOG || [];
            return catalog.find(item => item.catalogIndex === index) || catalog[0] || null;
        };

        const buildHighlights = entry => {
            const items = [];
            if (entry.destinationTitle) items.push(`Experience the best of ${entry.destinationTitle}`);
            if (entry.location) items.push(`Explore ${entry.location}`);
            if (entry.type) items.push(`${entry.type} adventure with curated guides`);
            if (entry.days) items.push(`${entry.days}-day immersion`);
            items.push('Personalized guides and curated activities');
            return items;
        };

        const buildItinerary = entry => {
            const rows = [];
            const days = entry.days || 5;
            for (let i = 1; i <= Math.min(days, 6); i += 1) {
                rows.push({
                    title: `Day ${i}`,
                    text: `Signature experience ${i} blends cultural immersion, comfortable stays, and relaxed evenings.`
                });
            }
            return rows;
        };

        const renderSimilar = entry => {
            const container = document.getElementById('similar-grid');
            if (!container) return;
            const catalog = (window.SEARCH_CATALOG || []).filter(item => item.catalogIndex !== entry.catalogIndex && item.destinationId === entry.destinationId);
            if (!catalog.length) {
                container.innerHTML = '<p>No similar experiences right now ‚Äî try expanding your search.</p>';
                return;
            }
            container.innerHTML = catalog.slice(0, 4).map(item => `
                <div class="similar-card">
                    <h4>${item.title}</h4>
                    <p class="muted">${item.type || 'Curated tour'}</p>
                    <p><strong>${item.priceLabel || formatCurrency(item.priceValue)}</strong></p>
                    <a href="tour.html?index=${item.catalogIndex}"><i class="fa-solid fa-arrow-right"></i> View tour</a>
                </div>
            `).join('');
        };

        const formatDepartureLabel = dateValue => {
            if (!dateValue) return 'Next departure coming soon';
            const parsed = new Date(dateValue);
            if (Number.isNaN(parsed)) return 'Next departure coming soon';
            const formatted = parsed.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            return `Next departure ${formatted}`;
        };

        document.addEventListener('DOMContentLoaded', () => {
            const entry = getTourEntry();
            if (!entry) {
                document.getElementById('tour-description').textContent = 'Tour not found.';
                return;
            }

            document.title = `${entry.title} | Wanderlust Adventures`;
            document.getElementById('tour-title').textContent = entry.title;
            document.getElementById('tour-location').textContent = entry.location || entry.destinationTitle || 'Worldwide';
            document.getElementById('tour-duration').textContent = `${entry.days || 'Varies'} day tour`;
            document.getElementById('tour-rating').textContent = entry.rating || 'Highly Rated';
            const priceLabelText = entry.priceLabel || formatCurrency(entry.priceValue);
            document.getElementById('tour-price-label').textContent = priceLabelText;
            const heroPriceCard = document.getElementById('tour-price-card');
            if (heroPriceCard) heroPriceCard.textContent = priceLabelText;
            document.getElementById('tour-description').textContent = entry.description || 'A carefully curated tour that highlights the best of each destination.';
            const departureEl = document.getElementById('tour-next-departure');
            if (departureEl) {
                departureEl.textContent = formatDepartureLabel(entry.publishedAt);
            }

            const hero = document.getElementById('tour-hero');
            if (hero && entry.image) {
                hero.style.backgroundImage = `linear-gradient(135deg, rgba(9, 12, 34, 0.8), rgba(4, 7, 26, 0.6)), url('${entry.image}')`;
            }

            document.getElementById('tour-includes').innerHTML = (entry.includes || ['Accommodation', 'Meals as noted', 'Guided experiences']).map(item => `<li>${item}</li>`).join('');
            document.getElementById('tour-highlights').innerHTML = buildHighlights(entry).map(item => `<li>${item}</li>`).join('');
            document.getElementById('tour-itinerary').innerHTML = buildItinerary(entry).map(row => `
                <div class="tour-itinerary-card">
                    <strong>${row.title}</strong>
                    <p>${row.text}</p>
                </div>
            `).join('');

            renderSimilar(entry);

            document.getElementById('book-tour').addEventListener('click', () => {
                alert('Great choice! Reach out via contact@wanderlust.com to confirm your booking.');
            });
            document.getElementById('download-itinerary').addEventListener('click', () => {
                alert('Itinerary preview has been added to your inbox (simulated).');
            });
        });
    </script>
</body>
</html>
